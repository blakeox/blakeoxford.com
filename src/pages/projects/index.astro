---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/BaseLayout.astro';
import ProjectCard from '../../components/ProjectCard.astro';
import ProjectRow from '../../components/ProjectRow.astro';

const projects = (await getCollection('projects')) as any[];
---

<Layout wide>
  <section class="c-projects-list w-full py-12 relative bg-gradient-to-r from-accent/10 to-background overflow-hidden rounded-none shadow-none animate-fade-in" role="region" aria-labelledby="projects-title">
    <div class="absolute top-0 right-0 w-64 h-64 bg-accent/20 rounded-full blur-3xl transform translate-x-1/2 -translate-y-1/2 pointer-events-none"></div>
    <div class="absolute bottom-0 left-0 w-48 h-48 bg-accent/20 rounded-full blur-3xl transform -translate-x-1/2 translate-y-1/2 pointer-events-none"></div>
    <h1 id="projects-title" class="text-4xl font-bold mb-4 text-accent-dark text-center animate-fade-in">Projects</h1>
    <p class="text-lg text-center mb-8 text-gray-700 dark:text-gray-300 animate-fade-in">Explore a curated collection of projects showcasing key skills in process automation, finance, and more. Use the filters to narrow your interests.</p>
    <div aria-hidden="true" class="w-full overflow-hidden pointer-events-none mb-8">
      <svg viewBox="0 0 1440 80" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-full h-16 md:h-20 lg:h-24">
        <path fill="currentColor" fill-opacity="0.08" d="M0,32 C360,80 1080,0 1440,48 L1440,80 L0,80 Z" />
      </svg>
    </div>

    <div class="flex flex-col gap-6 md:gap-4 w-full">
      {projects
        .filter((p: any) => !p.data.draft)
        .sort((a: any, b: any) => b.data.date.getTime() - a.data.date.getTime())
        .map((project: any, idx: number) => (
          <ProjectRow 
            project={project} 
            featured={["enterprise-digital-transformation","advancedmd-implementation","bank-projections-modeling"].includes(project.slug)}
            align={idx % 2 === 0 ? 'left' : 'right'}
          />
        ))}
    </div>
  </section>
</Layout>

<style>
.projects-masonry {
  /* Masonry layout for modern browsers */
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
  gap: 2rem;
}
@media (min-width: 640px) {
  .projects-masonry {
    grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
  }
}
@media (min-width: 1024px) {
  .projects-masonry {
    grid-template-columns: repeat(auto-fit, minmax(340px, 1fr));
  }
}
@supports (grid-template-rows: masonry) {
  .projects-masonry {
    grid-template-rows: masonry;
  }
}
</style>
